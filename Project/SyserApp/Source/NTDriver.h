#ifndef _INSTALL_DISK_H_
#define _INSTALL_DISK_H_

#include <WinSVC.h>

//////////////////////////////////////////////////////////////////////////////////
//安装驱动
//DriverName：驱动名
//DriverFileName：驱动程序文件名
//////////////////////////////////////////////////////////////////////////////////
bool InstallDriver(PCSTR DriverName,PCSTR DriverFileName=NULL,UINT StartType = SERVICE_DEMAND_START,PCSTR GroupName=NULL,DWORD Tag=-1);

//////////////////////////////////////////////////////////////////////////////////
//卸载驱动
//DriverName：驱动名
//bDeleteFile：是否删除其文件
//////////////////////////////////////////////////////////////////////////////////
bool UninstallDriver(PCSTR DriverName);
//////////////////////////////////////////////////////////////////////////////////
//创建驱动
//DriverName：驱动名
//DriverFileName：驱动程序文件名
//////////////////////////////////////////////////////////////////////////////////
bool CreateDriver(PCSTR DriverName,PCSTR FullDriver,UINT StartType = SERVICE_DEMAND_START);
//////////////////////////////////////////////////////////////////////////////////
//删除驱动
//DriverName：驱动名
//////////////////////////////////////////////////////////////////////////////////
bool RemoveDriver(PCSTR DriverName);
//////////////////////////////////////////////////////////////////////////////////
//启动驱动
//DriverName：驱动名
//////////////////////////////////////////////////////////////////////////////////
bool StartDriver(PCSTR DriverName);
//////////////////////////////////////////////////////////////////////////////////
//停止驱动
//DriverName：驱动名
//////////////////////////////////////////////////////////////////////////////////
bool StopDriver(PCSTR DriverName);
//////////////////////////////////////////////////////////////////////////////////
//驱动是否启动
//DriverName：驱动名
//////////////////////////////////////////////////////////////////////////////////
bool IsDriverActive(PCSTR DriverName);
//////////////////////////////////////////////////////////////////////////////////
//激活驱动，自动安装主程序目录下的驱动
//DriverName：驱动名
//////////////////////////////////////////////////////////////////////////////////
bool EnableDriver(PCSTR DriverName,PCSTR DriverFileName=NULL);
//////////////////////////////////////////////////////////////////////////////////
//关闭驱动
//DriverName：驱动名
//////////////////////////////////////////////////////////////////////////////////
bool DisableDriver(PCSTR DriverName);

bool InstallServiceGroup(PCSTR szGroup,PCSTR szPosAfter);
bool UninstallServiceGroup(PCSTR szGroup);

#endif
